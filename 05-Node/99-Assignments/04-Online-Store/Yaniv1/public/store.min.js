var __awaiter=this&&this.__awaiter||function(t,u,c,a){return new(c=c||Promise)(function(r,e){function n(t){try{i(a.next(t))}catch(t){e(t)}}function o(t){try{i(a.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?r(t.value):((e=t.value)instanceof c?e:new c(function(t){t(e)})).then(n,o)}i((a=a.apply(t,u||[])).next())})},__generator=this&&this.__generator||function(r,n){var o,i,u,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(u=2&e[0]?i.return:e[0]?i.throw||((u=i.return)&&u.call(i),0):i.next)&&!(u=u.call(i,e[1])).done)return u;switch(i=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,i=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(u=0<(u=c.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){c.label=e[1];break}if(6===e[0]&&c.label<u[1]){c.label=u[1],u=e;break}if(u&&c.label<u[2]){c.label=u[2],c.ops.push(e);break}u[2]&&c.ops.pop(),c.trys.pop();continue}e=n.call(r,c)}catch(t){e=[6,t],i=0}finally{o=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};function renderStore(y){return __awaiter(this,void 0,void 0,function(){var e,r,n,a,o,i,s,u,c,d,l,p,_,m,f,h,b;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,axios.get("/store/:storeUuid")];case 1:return e=t.sent(),r=e.data,n=r.store,a=r.isAdmin,o=document.querySelector("#in-cart"),i=document.querySelector("#cart"),a?[3,3]:[4,axios.get("/user/cart")];case 2:u=t.sent(),s=u.data.cartProducts,0===(c=s.reduce(function(t,e){return t+e.quantity},0))?(i.setAttribute("src","./images/empty-cart.png"),o.style.display="none"):(i.setAttribute("src","./images/full-cart.png"),o.style.display="unset",y&&swal({title:"You have items in your cart!",text:"What do you wanna do?",buttons:["More Shopping","Go to Cart"]}).then(function(t){t&&(window.location.href="./cart.html")})),o.innerText=c.toString(),t.label=3;case 3:return d=n.storeName,l=n.products,p=document.querySelector(".main__item--store-name"),_=document.querySelector("title"),p.innerText=d,_.innerText=d,m=document.querySelector(".products"),h=0<l.length,f=h?l.map(function(e){var t,r,n,o,i;o=a?'<i class="product-buttons__item product-buttons__item--delete fas fa-trash" title="Delete '+e.productName+'"></i>\n                    <i class="product-buttons__item product-buttons__item--edit fas fa-edit" title="Edit '+e.productName+'"></i>':(n=10===(r=(t=s.find(function(t){return t.productUuid===e.productUuid}))?t.quantity:0)?"disabled":"","<button "+(0===r?"disabled":"")+' class="product-buttons__item product-buttons__item--cart-reduce" title="Reduce quantity">-</button>\n                    <div class="product-buttons__item product-buttons__item--cart-quantity"'+(0===r?' style="background-color: gray;"':"")+' title="'+e.productName+' quantity">'+r+"</div>\n                    <button "+n+' class="product-buttons__item product-buttons__item--cart-add" title="Add quantity">+</button>');var u=0<e.inStock,c=0<e.inStock?(i=e.inStock+" left",5<e.inStock?"green":"orange"):(i="Out of Stock","red");return a||u?'<div class="products__item product" id="'+e.productUuid+'">\n                    <h3 class="product__item product__item--name">'+e.productName+'</h3>\n                    <a href="./product.html?productUuid='+e.productUuid+'" class="product__item product__item--img">\n                        <img src="'+e.productImage+'" title="'+e.productName+'"/>\n                    </a>\n                    <a href="./product.html?productUuid='+e.productUuid+'" title="'+e.productDescription+'" class="product__item product__item--description">'+e.productDescription+'</a>\n                    <h4 class="product__item product__item--price">'+(Math.round(100*e.productPrice)/100).toFixed(2)+'$</h4>\n                    <div class="product__item product__item--stock" style="color:'+c+'">'+i+'</div>\n                    <div class="product__item product-buttons">'+o+"</div>\n                    \n                </div>":""}).join(""):"no products to show!",m.innerHTML=f,[3,5];case 4:return b=t.sent(),console.error(b.message),[3,5];case 5:return[2]}})})}renderStore(!0);