"use strict";exports.__esModule=!0,exports.enoughInStock=exports.doesProductExist=void 0;var secret=require("../../secret/dist/secret").secret,_a=require("../../models/dist/storeModel"),Product=_a.Product,Store=_a.Store,_b=require("../../models/dist/usersModel"),Users=_b.Users,User=_b.User,CartProduct=_b.CartProduct;function doesProductExist(e,t,s){try{var o=new Store,r=new Users,d=e.params.productUuid?e.params.productUuid:e.body.productUuid,n=e.userIndex,c=o.findProductIndex(d),u=r.findCartProduct(n,d);return void(-1===c?t.status(404).send({message:"Product doesn't exist. Apologies for the inconvenience."}):(e.productIndex=c,e.cartProductIndex=u,s()))}catch(e){console.error(e.message),t.status(500).send(e.message)}}function enoughInStock(e,t,s){try{var o=new Store,r=new Users,d=e.body.productQuantity,n=e.productIndex,c=e.userIndex,u=e.cartProductIndex;return-1!==u?void(o.products[n].inStock+r.users[c].cart[u].quantity<d?t.status(409).send({message:"Not enough items in stock. Apologies for the inconvenience."}):s()):void(o.products[n].inStock<d?t.status(409).send({message:"Not enough items in stock. Apologies for the inconvenience."}):s())}catch(e){console.error(e.message),t.status(500).send(e.message)}}exports.doesProductExist=doesProductExist,exports.enoughInStock=enoughInStock;