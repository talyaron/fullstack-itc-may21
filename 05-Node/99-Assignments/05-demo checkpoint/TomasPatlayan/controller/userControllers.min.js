"use strict";exports.__esModule=!0,exports.searchByFirstname=exports.editUser=exports.bringInfo=exports.deleteUsers=exports.getAllUser=exports.registerUser=void 0;var userModel_1=require("../model/userModel"),fs=require("fs"),express=require("express"),app=express(),cookieParser=require("cookie-parser"),jwt=require("jsonwebtoken"),secret_1=require("../secret/secret");function searchByFirstname(e,r){var s=e.body.name,o=(new userModel_1.Users).searchStudentsByFirstname(s);console.log(o),r.send(o)}app.use(express.json()),app.use(cookieParser()),exports.registerUser=function(r,e){var s=r.body,o=s.name,n=s.color,t=s.image,i=new userModel_1.User(o,n,t),a=new userModel_1.Users;a.createUser(i);var d=userModel_1.readUsers().find(function(e){return e.name===r.body.name&&e.color===r.body.color}),l=jwt.sign(d,secret_1.secret);e.cookie("cookieName",JSON.stringify(l),{maxAge:101011010,httpOnly:!0}),e.send({message:"A new user has been register",allUsers:a})},exports.getAllUser=function(e,r){var s=new userModel_1.Users;console.log(s),r.send({message:"Geting all user Information",allUsers:s})},exports.deleteUsers=function(e,r){var s=e.params.id,o=new userModel_1.Users;o.deleteUser(s),r.send(o)},exports.bringInfo=function(e,r){var s=e.params.id,o=userModel_1.readUsers().find(function(e){return e.id===s});r.send(o)},exports.editUser=function(e,r){var s=e.params.id,o=e.body,n=o.name,t=o.color,i=o.image,a=userModel_1.readUsers(),d=a.find(function(e){return e.id===s});d.name=n,d.color=t,d.image=i,fs.writeFileSync("./db/users.json",JSON.stringify(a)),r.send(a)},exports.searchByFirstname=searchByFirstname;